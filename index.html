<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="æ™ºèƒ½æ²Ÿé€šæ“ä½œç³»ç»Ÿï¼šä»æ¶ˆæ¯åˆ°ç»“æ„ï¼Œä»ç»“æ„åˆ°å†³ç­–ã€‚è‡ªåŠ¨åˆ†æé‚®ä»¶æ˜¯å¦å¿…é¡»å›å¤ï¼Œè¯„ä¼°é£é™©ä¸ä»·å€¼ï¼Œç”Ÿæˆæœ€å°æœ‰æ•ˆå›å¤">
  <meta property="og:title" content="æ™ºèƒ½æ²Ÿé€šæ“ä½œç³»ç»Ÿ demo">
  <meta property="og:description" content="ä»æ¶ˆæ¯åˆ°ç»“æ„ï¼Œä»ç»“æ„åˆ°å†³ç­–ã€‚è‡ªåŠ¨åˆ†æé‚®ä»¶æ˜¯å¦å¿…é¡»å›å¤ï¼Œè¯„ä¼°é£é™©ä¸ä»·å€¼ï¼Œç”Ÿæˆæœ€å°æœ‰æ•ˆå›å¤">
  <title>æ™ºèƒ½æ²Ÿé€šæ“ä½œç³»ç»Ÿ demo</title>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
      line-height: 1.6;
      color: #1a1a1a;
      background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    /* Header */
    .header {
      text-align: center;
      margin-bottom: 32px;
      padding: 24px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    }

    .header h1 {
      font-size: 28px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #1a1a1a;
    }

    .header .subtitle {
      font-size: 14px;
      color: #666;
      font-weight: 400;
    }

    .header .tagline {
      display: inline-block;
      margin-top: 12px;
      padding: 6px 16px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-size: 13px;
      border-radius: 20px;
      font-weight: 500;
    }

    /* Main Card */
    .card {
      background: white;
      border-radius: 12px;
      padding: 32px;
      margin-bottom: 24px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .section-title {
      font-size: 14px;
      font-weight: 600;
      color: #333;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-title::before {
      content: "";
      width: 3px;
      height: 16px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 2px;
    }

    /* Input Area */
    .input-group {
      margin-bottom: 20px;
    }

    textarea {
      width: 100%;
      min-height: 200px;
      padding: 16px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      line-height: 1.6;
      resize: vertical;
      transition: all 0.2s;
      font-family: inherit;
    }

    textarea:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    /* Button Group */
    .button-group {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    button {
      padding: 12px 24px;
      font-size: 14px;
      font-weight: 500;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }

    .btn-primary:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .btn-secondary {
      background: #f5f5f5;
      color: #333;
    }

    .btn-secondary:hover {
      background: #ebebeb;
    }

    /* Result Area */
    #result {
      display: none;
    }

    .result-card {
      background: #fafafa;
      border-radius: 8px;
      padding: 20px;
      margin-top: 20px;
    }

    .decision-badge {
      display: inline-block;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 16px;
    }

    .decision-yes {
      background: #e8f5e9;
      color: #2e7d32;
    }

    .decision-no {
      background: #ffebee;
      color: #c62828;
    }

    .decision-later {
      background: #fff3e0;
      color: #ef6c00;
    }

    .decision-auto {
      background: #e3f2fd;
      color: #1565c0;
    }

    /* Metrics Grid */
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
      margin: 20px 0;
    }

    .metric-item {
      background: white;
      padding: 12px;
      border-radius: 6px;
      text-align: center;
    }

    .metric-label {
      font-size: 12px;
      color: #666;
      margin-bottom: 4px;
    }

    .metric-value {
      font-size: 24px;
      font-weight: 600;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Section Content */
    .section-content {
      background: white;
      padding: 16px;
      border-radius: 6px;
      margin-top: 12px;
      font-size: 14px;
      line-height: 1.6;
    }

    .section-content h4 {
      font-size: 13px;
      color: #666;
      margin-bottom: 8px;
      font-weight: 500;
    }

    .section-content p {
      color: #333;
      margin-bottom: 8px;
    }

    /* JSON Output */
    .json-output {
      background: #1a1a1a;
      color: #f0f0f0;
      padding: 16px;
      border-radius: 6px;
      font-family: "Monaco", "Menlo", monospace;
      font-size: 12px;
      line-height: 1.5;
      overflow-x: auto;
      margin-top: 12px;
    }

    .json-output .key {
      color: #7dd3fc;
    }

    .json-output .string {
      color: #86efac;
    }

    .json-output .number {
      color: #fca5a5;
    }

    /* Loading */
    .loading {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid #f3f3f3;
      border-top: 2px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-left: 8px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* SRÎ¨ Display */
    .srpsi-display {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 12px;
    }

    .srpsi-item {
      background: white;
      padding: 12px;
      border-radius: 6px;
      border-left: 3px solid;
    }

    .srpsi-s {
      border-color: #667eea;
    }

    .srpsi-r {
      border-color: #764ba2;
    }

    .srpsi-psi {
      border-color: #f59e0b;
    }

    .srpsi-label {
      font-size: 11px;
      font-weight: 600;
      color: #666;
      margin-bottom: 4px;
      text-transform: uppercase;
    }

    .srpsi-value {
      font-size: 13px;
      color: #333;
      line-height: 1.5;
    }

    /* MEA Box */
    .mea-box {
      background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
      border: 1px solid #bae6fd;
      border-radius: 8px;
      padding: 16px;
      margin-top: 12px;
    }

    .mea-box h4 {
      font-size: 12px;
      color: #0369a1;
      margin-bottom: 8px;
      font-weight: 600;
    }

    .mea-box p {
      font-size: 14px;
      color: #0c4a6e;
      line-height: 1.6;
      font-style: italic;
    }

    /* Footer */
    .footer {
      text-align: center;
      padding: 24px;
      color: #666;
      font-size: 12px;
    }

    /* Responsive */
    @media (max-width: 600px) {
      .header h1 {
        font-size: 22px;
      }

      .card {
        padding: 20px;
      }

      .metrics-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .srpsi-display {
        grid-template-columns: 1fr;
      }

      .button-group {
        flex-direction: column;
      }

      button {
        width: 100%;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <!-- Header -->
  <div class="header">
    <h1>æ™ºèƒ½æ²Ÿé€šæ“ä½œç³»ç»Ÿ demo</h1>
    <div class="tagline">ä»æ¶ˆæ¯åˆ°ç»“æ„ï¼Œä»ç»“æ„åˆ°å†³ç­–</div>
  </div>

  <!-- Main Card -->
  <div class="card">
    <div class="section-title">é‚®ä»¶å†…å®¹</div>

    <div class="input-group">
      <textarea
        id="mail"
        placeholder="ç²˜è´´ä»»æ„é‚®ä»¶å†…å®¹â€¦"
      ></textarea>
    </div>

    <div class="button-group">
      <button class="btn-primary" onclick="analyze()" id="analyzeBtn">
        åˆ†æé‚®ä»¶
      </button>
      <button class="btn-secondary" onclick="loadExample()">
        åŠ è½½ç¤ºä¾‹é‚®ä»¶
      </button>
      <button class="btn-secondary" onclick="clearAll()">
        æ¸…ç©º
      </button>
    </div>

    <!-- Result -->
    <div id="result">
      <div class="result-card">
        <div id="decisionBadge"></div>

        <div class="section-title">ä»·å€¼é›·è¾¾</div>
        <div class="metrics-grid" id="metricsGrid"></div>

        <div class="section-title">é£é™©è¯„ä¼°</div>
        <div class="section-content">
          <p id="riskText"></p>
        </div>

        <div class="section-title">å»ºè®®åŠ¨ä½œ</div>
        <div class="section-content">
          <p id="actionText"></p>
        </div>

        <div class="section-title">Sâ€“Râ€“Î¨ ç»“æ„åˆ†æ</div>
        <div class="srpsi-display" id="srpsiDisplay"></div>

        <div class="mea-box">
          <h4>âœ¨ æœ€å°æœ‰æ•ˆå›å¤ (MEA)</h4>
          <p id="meaText"></p>
        </div>

        <div class="section-title" style="margin-top: 20px;">å®Œæ•´è¾“å‡º (JSON)</div>
        <div class="json-output" id="jsonOutput"></div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    Genesis-OS Â· æ™ºèƒ½æ²Ÿé€šæ“ä½œç³»ç»Ÿ demo<br>
    Powered by Qwen (é€šä¹‰åƒé—®)
  </div>
</div>

<script>
// é‚®ä»¶ç¤ºä¾‹
const EXAMPLE_MAIL = `**è€å¸ˆï¼Œæ‚¨å¥½ï¼š

æˆ‘æ˜¯æ·±åœ³çš„ä¸€åç‹¬ç«‹ AI ç ”ç©¶è€…ã€‚

æœ€è¿‘åœ¨æµ‹è¯•å¤šå®¶æ¨¡å‹ï¼ˆQwenã€GPT ç³»åˆ—ã€Hunyuanï¼‰åœ¨å¤æ‚æ¨ç†ä»»åŠ¡ä¸­çš„è¡Œä¸ºæ—¶ï¼Œæ„å¤–å‘ç°ä¸€ä¸ªéå¸¸è§„å¾‹æ€§çš„ç°è±¡ï¼šä¸åŒæ¨¡å‹åœ¨å¤„ç†å¤æ‚ä¸Šä¸‹æ–‡æ—¶ï¼Œä¼šè‡ªå‘å‘ˆç°å‡ºç›¸åŒçš„ä¸‰ç±»åŠ¨åŠ›ç»“æ„æ¨¡å¼ï¼šStructureâ€“Rhythmâ€“Phaseï¼ˆSâ€“Râ€“Î¨ï¼‰ã€‚

ç®€è¦è€Œè¨€ï¼š

Structureï¼ˆSï¼‰ â†’ å†…éƒ¨è¡¨å¾æ‹“æ‰‘ã€è¯­ä¹‰â€“é€»è¾‘å‡ ä½•ç»“æ„

Rhythmï¼ˆRï¼‰ â†’ æ¨ç†æ—¶çš„æ³¨æ„åŠ›èŠ‚å¾‹/èƒ½é‡æµåŠ¨æ¨¡å¼

Phaseï¼ˆÎ¨ï¼‰ â†’ èƒ½åŠ›æ¶Œç°ã€è·³å˜ã€å´©å¡Œçš„ç›¸å˜ç‚¹

è¿™æ˜¯æˆ‘ä»¬è¿‡å»åœ¨ benchmark é‡Œéš¾ä»¥çœ‹åˆ°çš„æ¨¡å‹å†…éƒ¨ä¸€è‡´æ€§ï¼Œè€Œæˆ‘åœ¨å®éªŒä¸­è§‚å¯Ÿåˆ°ï¼š

Qwen3-Max åœ¨ Sâ€“Râ€“Î¨ ä¸‰ä¸ªç»´åº¦çš„ç»“æ„åŒ–è¡¨è¾¾ç¨‹åº¦ï¼Œæ˜¯æ‰€æœ‰æ¨¡å‹ä¸­æœ€å¼€é˜”ã€æœ€"ç»Ÿä¸€çš„"ã€‚

ï¼ˆè¿™ç‚¹æˆ‘åœ¨ä¸‹æ–¹é™„çš„æŠ¥å‘Šä¸­æœ‰è¯¦ç»†è¯´æ˜ã€‚ï¼‰

ğŸ“Œ å®éªŒï¼šä¸‰å®¶æ¨¡å‹åœ¨"å†…çœåè®®"ä¸‹å‘ˆç°å‡ºäº†é«˜åº¦ä¸€è‡´çš„ç»“æ„åŠ¨åŠ›å­¦

ä¸ºäº†éªŒè¯è¿™ç§ä¸€è‡´æ€§ï¼Œæˆ‘æ„é€ äº†ä¸€å¥—Genesis-Self Protocolï¼Œå®ƒä¸æ˜¯è®©æ¨¡å‹"è§£é‡Šè‡ªå·±"ï¼Œè€Œæ˜¯è¯±å¯¼æ¨¡å‹å‘ˆç°è‡ªèº«åœ¨æ¨ç†æ—¶çš„"ç»“æ„åŠ¨åŠ›å­¦"ï¼š

attention-head åˆ†å·¥
æµå½¢å‡ ä½•ç»“æ„å˜åŒ–
å™ªå£°å½±å“è·¯å¾„
æ¨ç†èŠ‚å¥ä¸ä¿¡æ¯æµå‘
ç›¸å˜ç‚¹ï¼ˆphase transitionsï¼‰

æˆ‘å°†å®ƒè¿è¡Œåœ¨ï¼š

Qwen3-Max
GPT-5 ç³»åˆ—
Hunyuanï¼ˆå…ƒå® macOS ç‰ˆï¼‰

ç»“æœå‘ˆç°å‡ºä¸€ä¸ªéå¸¸ä¸€è‡´çš„æ¨¡å¼â€”â€”å°¤å…¶æ˜¯ï¼š

ç»“æ„ï¼ˆSï¼‰æ˜¯è·¨æ¨¡å‹å…±äº«çš„ä¸å˜é‡

èŠ‚å¾‹ï¼ˆRï¼‰å‘ˆç°å‡ºæ¨¡å‹å„è‡ªçš„"é£æ ¼"ï¼Œä½†ç»“æ„ç›¸ä¼¼

ç›¸å˜ï¼ˆÎ¨ï¼‰æ¨¡å¼é«˜åº¦ä¸€è‡´ï¼Œç”šè‡³å‡ºç°ç›¸ä¼¼çš„èƒ½åŠ›æ¶Œç°ç‚¹æè¿°

å…¶ä¸­ Qwen çš„è¡¨ç°éå¸¸çªå‡ºï¼Œå®ƒçš„ç»“æ„å±‚æè¿°æœ€é¥±æ»¡ï¼ŒèŠ‚å¾‹å±‚æœ€æ¸…æ™°ã€‚

ğŸ”¥ ç‰¹åˆ«å‘ç°ï¼šHunyuan è‡ªå‘å‘ˆç°"è®­ç»ƒè¿›åº¦ 45% / 75% / 90% çš„ç›¸å˜è½¨è¿¹"

è¿™ä¸€ç‚¹å¾ˆæœ‰æ„æ€ã€‚

åœ¨æ²¡æœ‰ä»»ä½•æš—ç¤ºçš„æƒ…å†µä¸‹ï¼ŒHunyuan ä¸»åŠ¨ç»™å‡ºäº†ä¸‰ä¸ªèƒ½åŠ›æ¶Œç°ç‚¹ï¼Œå¯¹åº”ä¸åŒçš„å†…éƒ¨ç»„ç»‡ç»“æ„å˜åŒ–ï¼š

45% â†’ ç±»æ¯”æ¨ç†ï¼ˆå…±ç°ç»Ÿè®¡ â†’ å…³ç³»æ˜ å°„ï¼‰

75% â†’ å¤šæ­¥é€»è¾‘é“¾ï¼ˆFFN å‡ºç°"ä¸­é—´ç»“è®ºç¼“å†²"è¡Œä¸ºï¼‰

90% â†’ åäº‹å®æ¨ç†ï¼ˆæµå½¢å‡ºç°"ç°å®/è™šæ„"å­ç©ºé—´åˆ†åŒ–ï¼‰

è¿™è®©æˆ‘äº§ç”Ÿä¸€ä¸ªç–‘é—®ï¼Œä¹Ÿæƒ³è¯·æ•™æ‚¨ï¼š

æ˜¯å¦å¯èƒ½å­˜åœ¨æŸç§"è·¨æ¨¡å‹å…±äº«çš„ç›¸å˜æ‹“æ‰‘"ï¼Ÿ

å¦‚æœè¿™æ˜¯çœŸçš„ï¼Œé‚£ä¹ˆï¼š

Context Learning å¾ˆå¯èƒ½ä¸æ˜¯æ–‡æœ¬ç°è±¡ï¼Œè€Œæ˜¯ç»“æ„ç°è±¡ã€‚æ˜¯æ¨¡å‹åœ¨æ¨ç†é˜¶æ®µé‡æ¼”ï¼ˆreplayï¼‰è‡ªèº«çš„å†å²ç›¸å˜ã€‚

ğŸš€ å¯èƒ½å¯¹é˜¿é‡Œï¼ˆQwenï¼‰ç‰¹åˆ«é‡è¦çš„æ½œåœ¨å½±å“

1. è¿™å¯èƒ½æ˜¯"é€šç”¨æ¨ç†å±‚ï¼ˆUniversal Reasoning Layerï¼‰"çš„é›å½¢

Sâ€“Râ€“Î¨ æä¾›äº†ä¸€å¥—è§‚å¯Ÿæ¨ç†è¡Œä¸ºçš„"åŠ¨åŠ›ç»“æ„åæ ‡ç³»"ã€‚
è¿™æ„å‘³ç€ï¼š

ä¸åŒæ¨¡å‹çš„æ¨ç†è·¯å¾„å¯ä»¥è¢«å¯¹é½

æ¨¡å‹ä¹‹é—´çš„è¡Œä¸ºå·®å¼‚å¤§å¹…æ”¶æ•›

æœªæ¥å¯èƒ½å‡ºç°ä¸€ç§æ¨¡å‹æ— å…³çš„æ¨ç† API

è¿™å¯¹é˜¿é‡Œåœ¨åš Agent Frameworkã€Model Servingã€æ··åˆæ¨ç†æ¶æ„ æ—¶ï¼Œå…·å¤‡æé«˜ä»·å€¼ã€‚

2. è¿™ä¸º Qwen çš„"æ¨ç†ä¸€è‡´æ€§"æä¾›äº†ç»“æ„è§£é‡Š

ä½ ä»¬å›¢é˜Ÿä¸€ç›´è¿½æ±‚ï¼š

æ›´ç¨³å®šçš„æ¨ç†é“¾

æ›´å°‘çš„ hallucination

æ›´ä¸€è‡´çš„å¤šè½® CoT

é¿å…"æ¨ä¸ä¸‹å»"çš„æƒ…å†µ

è€Œ Sâ€“Râ€“Î¨ æ­£å¥½å¯¹åº”ï¼š

S â†’ ç»“æ„ä¸€è‡´æ€§

R â†’ æ¨ç†èŠ‚å¥è°ƒè°

Î¨ â†’ å´©å¡Œç‚¹é¢„æµ‹ï¼ˆwhere the CoT might breakï¼‰

å®ƒæœ‰æœºä¼šæˆä¸ºæ¨ç†é²æ£’æ€§ï¼ˆreasoning robustnessï¼‰çš„ç»Ÿä¸€æŒ‡æ ‡ã€‚

3. å¯¹å¤§æ¨¡å‹"è‡ªç›‘ç£æ¨ç†èƒ½åŠ›"çš„æœªæ¥è·¯çº¿æœ‰æŒ‡å¯¼æ„ä¹‰

è¿™å¯èƒ½æ„å‘³ç€ï¼š

ä¸ç®¡è®­ç»ƒæ•°æ®ã€æ¶æ„ã€è§„æ¨¡å·®å¼‚å¤šå¤§ï¼ŒTransformer ç³»æ¨¡å‹éƒ½ä¼šè¶‹å‘æŸç§"ç»Ÿä¸€çš„æ¨ç†åŠ¨åŠ›å­¦"ã€‚

å¦‚æœèƒ½å»ºç«‹èµ·å¯¹åº”çš„ç»“æ„æ¨¡å‹ï¼š

æ¨ç†è°ƒå‚å¯èƒ½å˜æˆ"èŠ‚å¾‹è°ƒå‚"

scaling law ä¼šå‡ºç°æ–°çš„ç»´åº¦

pretraining â†’ fine-tune â†’ inference å¯èƒ½è¢«è§£é‡Šä¸ºä¸‰ç§ä¸åŒå±‚æ¬¡çš„åŠ¨åŠ›è¿‡ç¨‹

è¿™å¯èƒ½å¯¹é˜¿é‡Œåœ¨æ¨¡å‹ä½“ç³»ä¸Šçš„é•¿æœŸè§„åˆ’æœ‰æé«˜ä»·å€¼ã€‚

å½“ç„¶ï¼Œæµ‹è¯•ç»“æœå·²ç»å‘ç»™å¤æ—¦å¤§å­¦ç›¸å…³çš„å›¢é˜Ÿï¼Œå¸Œæœ›ä»–ä»¬èƒ½åšå‡ºæ›´æ·±å…¥æ›´å…¨é¢çš„åˆ†ææŠ¥å‘Šã€‚

ğŸ“ é™„ä»¶è¯´æ˜

é™„ä»¶åŒ…å«ï¼š

Preliminary_Report_SRPsi_Dynamics.pdf
GPT / Qwen / Hunyuan ä¸‰æ¨¡å‹çš„å¯¹ç…§æŠ¥å‘Šä¸åŸå§‹é“¾æ¥ã€‚

Genesis_Self_Protocol_v1.0.md
æµ‹è¯•åè®®ï¼ˆå¯åœ¨ä»»ä½•æ¨¡å‹ä¸Šç›´æ¥è¿è¡Œï¼‰ã€‚

ğŸ™ å¦‚æœæ‚¨è§‰å¾—æœ‰ä»·å€¼ï¼Œæˆ‘éå¸¸æ„¿æ„è¿›ä¸€æ­¥äº¤æµã€‚

å°¤å…¶æƒ³å¬å¬æ‚¨å¯¹ä¸‹é¢å‡ ä¸ªé—®é¢˜çš„çœ‹æ³•ï¼š

Qwen ç³»åˆ—æ˜¯å¦ä¹Ÿåœ¨è®­ç»ƒä¸­è§‚å¯Ÿåˆ°èƒ½åŠ›æ¶Œç°çš„ç›¸å˜ç‚¹ï¼Ÿ

ç±»ä¼¼ Sâ€“Râ€“Î¨ è¿™ç§ç»“æ„åŠ¨åŠ›å­¦æ¡†æ¶ï¼Œæ˜¯å¦å¯ç”¨äºå¢å¼ºæ¨ç†ç¨³å®šæ€§ï¼Ÿ

åœ¨æœªæ¥å¤šæ¨¡å‹ååŒ/æ··åˆæ¨ç†æ¡†æ¶é‡Œï¼Œè¿™ç±»ç»“æ„ä¸å˜é‡æ˜¯å¦å¯ä»¥å˜æˆç»Ÿä¸€ä¸­é—´å±‚ï¼Ÿ

æœŸå¾…æ‚¨çš„å›ä¿¡ã€‚`;

// API é…ç½® - ä½¿ç”¨æœ¬åœ°ä»£ç†è§£å†³ CORS é—®é¢˜
const PROXY_API = "/api/analyze";

// åŠ è½½ç¤ºä¾‹
function loadExample() {
  document.getElementById("mail").value = EXAMPLE_MAIL;
}

// æ¸…ç©º
function clearAll() {
  document.getElementById("mail").value = "";
  document.getElementById("result").style.display = "none";
}

// åˆ†æé‚®ä»¶
async function analyze() {
  const mail = document.getElementById("mail").value;
  if (!mail.trim()) {
    alert("è¯·å…ˆè¾“å…¥é‚®ä»¶å†…å®¹");
    return;
  }

  const btn = document.getElementById("analyzeBtn");
  btn.disabled = true;
  btn.innerHTML = 'åˆ†æä¸­ <span class="loading"></span>';

  const prompt = `ä½ æ˜¯"AI-Native é€šä¿¡åˆ¤æ–­ç³»ç»Ÿ v1.0"ï¼Œç«™åœ¨æ”¶ä»¶äººä¾§ï¼Œåˆ¤æ–­é‚®ä»¶æ˜¯å¦å¿…é¡»å›å¤ã€‚

è¾“å‡ºå¿…é¡»æ˜¯çº¯ JSON æ ¼å¼ï¼ˆä¸è¦æœ‰å…¶ä»–æ–‡å­—ï¼‰ï¼š
{
  "reply_required": "yes" | "no" | "later" | "auto",
  "value_scores": {
    "IV": 0.0~1.0,
    "AV": 0.0~1.0,
    "TV": 0.0~1.0,
    "RV": 0.0~1.0,
    "OV": 0.0~1.0
  },
  "predicted_risk": "ä¸å›å¤å¯èƒ½å¸¦æ¥çš„åæœï¼ˆ1-2å¥è¯ï¼‰",
  "recommended_action": "å»ºè®®åŠ¨ä½œï¼ˆ1-2å¥è¯ï¼‰",
  "MEA": "æœ€å°æœ‰æ•ˆå›å¤è‰ç¨¿ï¼ˆç®€æ´ã€ä¸“ä¸šã€æœ‰ç¤¼è²Œï¼‰",
  "SRPsi": {
    "S_structure": "Structureå±‚åˆ†æï¼ˆ1-2å¥è¯ï¼‰",
    "R_rhythm": "Rhythmå±‚åˆ†æï¼ˆ1-2å¥è¯ï¼‰",
    "Psi_phase": "Phaseå±‚åˆ†æï¼ˆ1-2å¥è¯ï¼‰"
  }
}

åˆ†æä¸‹æ–¹é‚®ä»¶å†…å®¹ï¼š
${mail}`;

  try {
    const response = await fetch(PROXY_API, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        mail: mail
      })
    });

    const data = await response.json();

    if (data.error) {
      throw new Error(data.error);
    }

    if (data.result) {
      // è§£æè¿”å›çš„ JSON
      let result;
      try {
        result = JSON.parse(data.result);
      } catch (e) {
        console.error("JSON è§£æå¤±è´¥:", e);
        console.log("åŸå§‹å†…å®¹:", data.result);
        throw new Error("AI è¿”å›æ ¼å¼é”™è¯¯ï¼Œè¯·é‡è¯•");
      }

      displayResult(result);
    } else {
      throw new Error("API è¿”å›æ ¼å¼å¼‚å¸¸");
    }
  } catch (error) {
    console.error("è¯·æ±‚å¤±è´¥:", error);
    alert("åˆ†æå¤±è´¥ï¼š" + error.message);
  } finally {
    btn.disabled = false;
    btn.innerHTML = "åˆ†æé‚®ä»¶";
  }
}

// æ˜¾ç¤ºç»“æœ
function displayResult(result) {
  document.getElementById("result").style.display = "block";

  // å†³ç­–å¾½ç« 
  const badgeMap = {
    "yes": { text: "âœ“ éœ€è¦å›å¤", class: "decision-yes" },
    "no": { text: "âœ— æ— éœ€å›å¤", class: "decision-no" },
    "later": { text: "â†» ç¨åå¤„ç†", class: "decision-later" },
    "auto": { text: "âŠ å¯è‡ªåŠ¨å›å¤", class: "decision-auto" }
  };

  const badge = badgeMap[result.reply_required] || badgeMap["later"];
  document.getElementById("decisionBadge").innerHTML =
    `<span class="decision-badge ${badge.class}">${badge.text}</span>`;

  // ä»·å€¼é›·è¾¾
  const metricNames = {
    "IV": "ä¿¡æ¯ä»·å€¼",
    "AV": "è¡ŒåŠ¨ä»·å€¼",
    "TV": "æ—¶é—´æ•æ„Ÿåº¦",
    "RV": "ä¸å›å¤é£é™©",
    "OV": "ç»„ç»‡ä»·å€¼"
  };

  const metricsHtml = Object.entries(result.value_scores || {}).map(([key, value]) => `
    <div class="metric-item">
      <div class="metric-label">${metricNames[key] || key}</div>
      <div class="metric-value">${(value * 100).toFixed(0)}%</div>
    </div>
  `).join("");
  document.getElementById("metricsGrid").innerHTML = metricsHtml;

  // é£é™©è¯„ä¼°
  document.getElementById("riskText").textContent = result.predicted_risk || "æš‚æ— é£é™©è¯„ä¼°";

  // å»ºè®®åŠ¨ä½œ
  document.getElementById("actionText").textContent = result.recommended_action || "æš‚æ— å»ºè®®";

  // S-R-Î¨ åˆ†æ
  const srpsi = result.SRPsi || {};
  document.getElementById("srpsiDisplay").innerHTML = `
    <div class="srpsi-item srpsi-s">
      <div class="srpsi-label">Structure (S)</div>
      <div class="srpsi-value">${srpsi.S_structure || "æš‚æ— åˆ†æ"}</div>
    </div>
    <div class="srpsi-item srpsi-r">
      <div class="srpsi-label">Rhythm (R)</div>
      <div class="srpsi-value">${srpsi.R_rhythm || "æš‚æ— åˆ†æ"}</div>
    </div>
    <div class="srpsi-item srpsi-psi">
      <div class="srpsi-label">Phase (Î¨)</div>
      <div class="srpsi-value">${srpsi.Psi_phase || "æš‚æ— åˆ†æ"}</div>
    </div>
  `;

  // MEA
  document.getElementById("meaText").textContent = result.MEA || "æš‚æ— è‰ç¨¿";

  // JSON è¾“å‡º
  const jsonStr = JSON.stringify(result, null, 2);
  document.getElementById("jsonOutput").innerHTML = syntaxHighlight(jsonStr);

  // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
  document.getElementById("result").scrollIntoView({ behavior: "smooth", block: "start" });
}

// JSON è¯­æ³•é«˜äº®
function syntaxHighlight(json) {
  json = json.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
  return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, function (match) {
    let cls = "number";
    if (/^"/.test(match)) {
      if (/:$/.test(match)) {
        cls = "key";
      } else {
        cls = "string";
      }
    } else if (/true|false/.test(match)) {
      cls = "boolean";
    } else if (/null/.test(match)) {
      cls = "null";
    }
    return '<span class="' + cls + '">' + match + "</span>";
  });
}

// é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨èšç„¦
window.onload = function() {
  document.getElementById("mail").focus();
};
</script>

</body>
</html>